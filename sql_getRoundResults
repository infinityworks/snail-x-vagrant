SELECT
  snailRaceResults.race_id,
	snailRaceResults.position,
	snails.name, trainers.name

FROM
	(SELECT snailRaces.race_id,
		snailRaces.snail_id,
		raceresult.position

	FROM
		(SELECT racecard.race_id,
			racecard.snail_id,
			race.round_id,
			race.race_date
		FROM racecard
		JOIN race ON racecard.race_id = race.race_id

		WHERE race.round_id IN

			(SELECT round_id
			FROM

				(SELECT round.round_id,
					MAX(round.start_date) AS start_date
				FROM round
				WHERE round.closed = 'f'
				GROUP BY round.round_id) AS maxDateQuery))
			AS snailRaces

		JOIN raceresult ON snailRaces.race_id = raceresult.race_id
		AND snailRaces.snail_id = raceresult.snail_id)
	AS snailRaceResults
	JOIN snails ON snailRaceResults.snail_id = snails.snail_id
	JOIN trainers ON snails.trainer_id = trainers.trainer_id;
